---
title: 'Status of Pacific ocean perch (*Sebastes alutus*) along the U.S. west coast in 2017'
author: ''
date: ''
output:
  pdf_document:
    fig_caption: yes
    highlight: haddock
    includes:
      before_body: Titlepage.tex
      in_header: header.tex
    keep_tex: yes
    template: Default_template_modified.tex
    number_sections: yes
    toc: yes
    toc_depth: 4
  html_document:
    toc: yes
  word_document: default
documentclass: article
fontsize: 12pt
geometry: margin=1in
csl: CJFAS.csl
bibliography: BibFile.bib
link-citations: yes
---
```{r global_options, include=FALSE}
    # set global options for R code chunks: echo=FALSE (don't include source code); 
    # warning=FALSE (suppress R warnings); message=FALSE (suppress R messages)
    # eval = TRUE is default
    knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r}
    # Read in preamble R code - including required libraries and the SS file(s)
    source('./Rcode/Preamble.R')
 
    # Read in data/manipulations for executive summary tables and figures
    # It may take time to edit this file and get it ready for your assessment
    # Make small changes in this file and then try to compile the document
    # Commit when you have a success!
    source('./Rcode/Exec_summary_figs_tables.R')
```
\setlength{\parskip}{5mm plus1mm minus1mm}
\pagebreak

\pagenumbering{arabic}
\setcounter{page}{1}
\renewcommand{\thefigure}{\alph{figure}}
\renewcommand{\thetable}{\alph{table}}



#Executive Summary{-}

##Stock{-}
This assessment reports the status of the `r spp` (\emph{`r spp.sci`}) speciess off rockfish
off the U.S. West Coast from Northern California to the Canadian Border using data 
through `r LastYR`.  `r spp` are most abundant in the Gulf of Alaska and have observed off of Japan, in the Bering Sea, and south to Baja California,
although they are sparse south of Oregon and rare in southern California. \hl{Composition data indicate that
good recruitment years coincide in Oregon and Washington.} To date, no significant genetic differences have
been found in the range covered by this assessment.


##Catches{-}
The first year that harvest of `r spp` exceeded 1 mt off the U.S. West Coast first occured in 1929.  Catches ramped up in the 1940s with large removals in Washington waters.  During the 1950s the removals primarly occured in Oregon waters with catches from Washington declining following the 1940s. The largest removals in 1966-1968 were largely a result of harvest by foreing vessels.  The fishery proceed with more moderate removals ranging between 1,200 to 2,600 metric  tons per year between 1969 to 1980. Removals generally decined from 1981 to 1994 to between 1,000 and 1,700 metric tons per year. `r spp` was declared overfished in 1999 resulting in large reduction in harvest in recent years since the declaration.


<!-- Catch table:                 (Table \ref{tab:Exec_catch})

Catch figure(s) with fleets: (Figures \ref{fig:Exec_catch1}-\ref{fig:Exec_catch3})  -->  

<!-- ***********CATCH TABLE************************************************ -->
```{r, results='asis'}
    #CSV: './txt_files/Exec_catch_summary.csv'
    # Catch table section in R_exec_summary_fig_tables.R
    # Print the table
    print(Exec_catch.table, include.rownames = FALSE, caption.placement = 'top')
```
<!-- ***********END EXECUTIVE SUMMARY CATCH FIGURES AND TABLES************* -->



\FloatBarrier

<!-- ***********BEGIN EXECUTIVE SUMMARY CATCH FIGURES AND TABLES*********** -->
<!-- ***********Edit the Plot_catch tables and captions******************** -->
<!-- ***********This depends on how many plots you need******************** -->
<!-- ***********Also included is the r4SS plot - keep or remove************ -->
<!-- ***********CATCH FIGURES********************************************** -->
```{r, fig.cap= paste('Landings of' ,spp, 'for California, Oregon, Washington, the foriegn fishery (1966-1976), at-sea-hake fishery, and fishery independent surveys. \\label{fig:Exec_catch1}',sep=' ')}
    # CSV: './txt_files/Exec_catch_for_figs.csv'
    # Note: you cannot have carriage returns in the R options line
    # Plot washington catches           
    Plot_catch(Catch_df = Exec_region1_catch)
```


<!--\FloatBarrier

![Landings history of `r spp` in the `r mod1_label`. \label{fig:r4ss_catches}](r4ss/plots_mod1/catch1 landings.png)-->

<!--\FloatBarrier


\newpage -->

##Data and Assessment{-}
This a new full assessment for `r spp` which was last assessed in 2011.  In this assessment, all aspects of the model including catches, data, and modelling assumptions were re-evaluated as much as possible. The assessment was conducted using the length- and age-structured modeling software Stock Synthesis (version 3.30).  The coastwide population was modeled assuming separate growth and mortality parameters for each sex (a two-sex model) from `r Dat_start_mod1` to `r LastYR`, and forecasted beyond `r LastYR`.


<!--Map of assessment region: (Figure \ref{fig:assess_region_map}).  
 
![Map depicting the boundaries for the base-case model.  \label{fig:assess_region_map}](Figures/assess_region_map.png) -->

\FloatBarrier


##Stock Biomass{-}
\hl{Include: trends and current levels relative to virgin or historic levels, 
description of uncertainty-include table for last 10 years and graph with 
long term estimates.}

Spawning output Figure:    Figure \ref{fig:Spawnbio_all}     
Spawning output Table(s):  Table \ref{tab:SpawningDeplete_mod1}     
Relative depletion Figure: Figure \ref{fig:RelDeplete_all}     


Example text (remove Models 2 and 3 if not needed - if using, remove the # in-line comments!!!)      
The estimated relative depletion level (spawning output relative to unfished 
spawning output) of the the base-case model in `r LastYR` is `r Depl_mod1` 
(~95% asymptotic interval: $\pm$ `r Depl_mod1_CI`) (Figure \ref{fig:RelDeplete_all}).

The estimated relative depletion level of model 2 in `r LastYR` is 
`r if(n_models>=2){Depl_mod2}` (~95% asymptotic interval: $\pm$ `r if(n_models>=2){Depl_mod2_CI}`) (Figure \ref{fig:RelDeplete_all}). 

The estimated relative depletion level of model 3 in `r LastYR` is 
`r if(n_models==3){Depl_mod3}` (~95% asymptotic interval: $\pm$ `r if(n_models==3){Depl_mod3_CI}`) (Figure \ref{fig:RelDeplete_all}).


\FloatBarrier


<!--BEGIN  EXECUTIVE SUMMARY SPAWNING BIOMASS AND DEPLETE TABLES AND FIGURES-->
```{r, results='asis'}
    # Print spawning biomass table(s)
    print(Spawn_Deplete_mod1.table, include.rownames = FALSE, caption.placement = 'top')
    if(n_models >= 2) {print(Spawn_Deplete_mod2.table, include.rownames = FALSE, caption.placement = 'top')}
    if(n_models == 3) {print(Spawn_Deplete_mod3.table, include.rownames = FALSE, caption.placement = 'top')}

    # Select which file to use for the recuitment figure, depending on if you have one model or multiple models
    if(n_models == 1) {
      spawn.file  = ifelse(fecund=='numbers',
                           'r4ss/plots_mod1/ts7_Spawning_output_with_95_asymptotic_intervals_intervals.png',
                           'r4ss/plots_mod1/ts7_Spawning_biomass_(mt)_with_95_asymptotic_intervals_intervals.png')
      Bratio.file = 'r4ss/plots_mod1/ts9_Spawning_depletion_with_95_asymptotic_intervals_intervals.png' 
     } else {
      spawn.file  = 'r4ss/plots_compare/base_compare2_spawnbio_uncertainty.png'
      Bratio.file = 'r4ss/plots_compare/base_compare4_Bratio_uncertainty.png'
    }  
```

\FloatBarrier


![Time series of spawning output trajectory (circles and line: median; light broken lines: 95% credibility intervals) for the base case assessment model.  \label{fig:Spawnbio_all}](`r spawn.file`)

![Estimated relative depletion with approximate 95\% asymptotic confidnce intervals (dashed lines) for the base case assessment model. \label{fig:RelDeplete_all}](`r Bratio.file`)

<!-- ***********END  EXECUTIVE SUMMARY SPAWNING BIOMASS AND**************** -->


<!-- ***********DEPLETION TABLES AND FIGURES******************************* -->

\FloatBarrier



##Recruitment{-}
\hl{Include: trends and current levels relative to virgin or historic levels-include 
table for last 10 years and graph with long term estimates.}

Recruitment Figure: (Figure \ref{fig:Recruits_all})     
Recruitment Tables: (Tables \ref{tab:Recruit_mod1}, \ref{tab:Recruit_mod2} 
and \ref{tab:Recruit_mod3})



<!-- ***********BEGIN EXECUTIVE SUMMARY RECRUITMENT TABLES AND FIGURES***** -->
```{r, results='asis'}
   # Print recruitment tables; will print up to 3 depending on the number of models, you can delete the code
   # for models you don't need as well
   print(Recruit_mod1.table, include.rownames = FALSE, caption.placement = 'top')
   
   if(n_models >= 2) {
     print(Recruit_mod2.table, include.rownames = FALSE, caption.placement = 'top')
   }
   
   if(n_models == 3) {
     print(Recruit_mod3.table, include.rownames = FALSE, caption.placement = 'top')
   }

   # select which file to use for the recuitment figure, depending on if you have one model or multiple models
   if(n_models==1) {
     recruit.file  = 'r4ss/plots_mod1/ts11_Age-0_recruits_(1000s)_with_95_asymptotic_intervals.png'
    } else {
     recruit.file  = 'r4ss/plots_compare/base_compare8_recruits_uncertainty.png'}
```

\FloatBarrier

![Time series of estimated `r spp` recruitments for the base-case model with 95\% confidence or credibility intervals. \label{fig:Recruits_all}](`r recruit.file`)

<!-- ***********END EXECUTIVE SUMMARY RECRUITMENT TABLEs AND FIGURES******* -->

 \FloatBarrier



##Exploitation status{-}
\hl{Include: exploitation rates (i.e., total catch divided by exploitable biomass, or the annual SPR harvest rate) â€“ include a table with the last 10 years of data and a graph showing the trend in fishing mortality relative to the target (y-axis) plotted against the trend in biomass relative to the target (x-axis).}


Exploitation Tables: Table \ref{tab:SPR_Exploit_mod1}, Table \ref{tab:SPR_Exploit_mod2}, Table \ref{tab:SPR_Exploit_mod3}
Exploitation Figure: Figure \ref{fig:SPR_all}). 

A summary of `r spp` exploitation histories for base model is provided as Figure \ref{fig:Phase_all}.


\FloatBarrier

<!-- ***********BEGIN EXECUTIVE SUMMARY EXPLOITATION AND******************* -->
<!-- ***********SPRratio TABLE AND FIGURES********************************* -->
```{r, results='asis'}
   # Print exploitation and SPRratio tables depending on how many models there are
   if(n_models >= 1) {
     print(SPRratio_Exploit_mod1.table, include.rownames = FALSE, caption.placement = 'top')
   }
    
   if(n_models >= 2) {
     print(SPRratio_Exploit_mod2.table, include.rownames = FALSE, caption.placement = 'top')
   }
   
   if(n_models == 3) {
     print(SPRratio_Exploit_mod3.table, include.rownames = FALSE, caption.placement = 'top')
   }

   # select the files for the SPR and phase plots depending on the number of models
   if(n_models == 1) {
     SPR.file   = 'r4ss/plots_mod1/SPR3_ratiointerval.png'
     Phase.file = 'r4ss/plots_mod1/SPR4_phase.png' 
    } else {
     SPR.file   = 'r4ss/plots_compare/base_compare6_SPRratio_uncertainty.png'
     Phase.file = 'r4ss/plots_compare/base_compare13_phase_plot.png'}  
```

\FloatBarrier

![Estimated spawning potential ratio (SPR) for the base-case model. One minus SPR is plotted so that higher exploitation rates occur on the upper portion of the y-axis. The management target is plotted as a red horizontal line and values above this reflect harvests in excess of the overfishing proxy based on the SPR\textsubscript{50\%} harvest rate. The last year in the time series is `r Dat_end_mod1`. \label{fig:SPR_all}](`r SPR.file`)


![Phase plot of estimated relative (1-SPR) vs. relative spawning biomass for the base case model. The relative (1-SPR) is (1-SPR) divided by 50\% (the SPR target). Relative depletion is the annual spawning biomass divided by the unfished spawning biomass. \label{fig:Phase_all}](`r Phase.file`)

<!-- ************END EXECUTIVE SUMMARY EXPLOITATION************************ -->
<!-- ************AND SPRratio TABLE AND FIGURES**************************** -->

\FloatBarrier




##Ecosystem Considerations{-}
In this assessment, ecosystem considerations were.....




##Reference Points{-}
\hl{Include:} management targets and definition of overfishing, including the harvest 
rate that brings the stock to equilibrium at $B_{40\%}$ (the $B_{MSY}$ proxy) and 
the equilibrium stock size that results from fishing at the default harvest rate 
(the $F_{MSY}$ proxy). Include a summary table that compares estimated reference 
points for SSB, SPR, Exploitation Rate and Yield based on SSBproxy for MSY, 
SPRproxy for MSY, and estimated MSY values

\hl{Write intro paragraph....and remove text for Models 2 and 3 if not needed}

This stock assessment estimates that `r spp` in the `r mod1_label` are 
`r ifelse(Deplete_mod1[nrow(Deplete_mod1),2]-MT>0,"above","below")` the biomass 
target, but `r ifelse(Deplete_mod1[nrow(Deplete_mod1),2]-MSST>0,"above","below")` 
the minimum stock size threshold.  \hl{Add sentence about spawning output trend.} 
The estimated relative depletion level for \hl{Model 1} in `r LastYR` is 
`r Depl_mod1` (~95% asymptotic interval: $\pm$ `r Depl_mod1_CI`, corresponding 
to an unfished spawning output of `r paste(Spawn_mod1, fecund_unit,sep=' ')` 
(~95% asymptotic interval: `r paste(Spawn_mod1_CI, fecund_unit, sep=' ')`) of 
spawning output in the base model (Table \ref{tab:Ref_pts_mod1}).  Unfished 
age `r min_age` biomass was estimated to be `r Ref_pts_mod1[2,2]` mt in the 
base case model. The target spawning output based on the biomass target 
($SB_{40\%}$) is `r paste(Ref_pts_mod1[7,2], fecund_unit,sep=' ')`, which gives 
a catch of `r Ref_pts_mod1[10,2]` mt. Equilibrium yield at the proxy $F_{MSY}$ 
harvest rate corresponding to $SPR_{50\%}$ is `r Ref_pts_mod1[15,2]` mt.

This stock assessment estimates that `r spp` in the `r if(n_models>=2){mod2_label}` are 
`r if(n_models>=2){ifelse(Deplete_mod2[nrow(Deplete_mod2),2]-MT>0,"above","below")}` 
the biomass target, but `r if(n_models>=2){ifelse(Deplete_mod2[nrow(Deplete_mod2),2]-MSST>0,"above","below")}` 
the minimum stock size threshold. \hl{Add sentence about spawning output trend.} The 
estimated relative depletion level for \hl{Model 2} in `r LastYR` is 
`r if(n_models>=2){Depl_mod2}` (~95% asymptotic interval: $\pm$ 
`r if(n_models>=2){Depl_mod2_CI}`), corresponding to an unfished spawning output of 
`r if(n_models>=2){paste(Spawn_mod2, fecund_unit, sep=' ')}` (~95% asymptotic interval: 
`r #paste(Spawn_mod2_CI, fecund_unit, sep=' ')`) of 
spawning output in the base model (Table \ref{tab:Ref_pts_mod2}). Unfished 
age `r min_age` biomass was estimated to be `r if(n_models>=2){Ref_pts_mod2[2,2]}` 
mt in the base case model. The target spawning output based on the biomass target 
($SB_{40\%}$) is `r if(n_models>=2){paste(Ref_pts_mod2[7,2], fecund_unit,sep=' ')}`, 
which gives a catch of `r #Ref_pts_mod2[10,2]` mt. Equilibrium yield at the proxy $F_{MSY}$ 
harvest rate corresponding to $SPR_{50\%}$ is `r if(n_models>=2){Ref_pts_mod2[15,2]}` mt.

This stock assessment estimates that `r spp` in the `r if(n_models==3){mod3_label}` are 
`r if(n_models==3){ifelse(Deplete_mod3[nrow(Deplete_mod3),2]-MT>0,"above","below")}` 
the biomass target, but `r if(n_models==3){ifelse(Deplete_mod3[nrow(Deplete_mod3),2]-MSST>0,"above","below")}` 
the minimum stock size threshold. \hl{Add sentence about spawning output trend.} The 
estimated relative depletion level or \hl{Model 3} in `r LastYR` is 
`r if(n_models==3){Depl_mod3}` (~95% asymptotic interval: $\pm$
`r if(n_models==3){Depl_mod3_CI}`), corresponding to an unfished spawning output of 
`r if(n_models==3){paste(Spawn_mod3, fecund_unit, sep=' ')}` (~95% asymptotic interval:
`r if(n_models==3){paste(Spawn_mod3_CI, fecund_unit,sep=' ')}`) of 
spawning output in the base model (Table \ref{tab:Ref_pts_mod3}). Unfished 
age `r min_age` biomass was estimated to be `r if(n_models==3){Ref_pts_mod3[2,2]}` mt in the 
base case model. The target spawning output based on the biomass target 
($SB_{40\%}$) is `r if(n_models==3){paste(Ref_pts_mod3[7,2], fecund_unit, sep=' ')}`, which gives 
a catch of `r #Ref_pts_mod3[10,2]` mt. Equilibrium yield at the proxy $F_{MSY}$ 
harvest rate corresponding to $SPR_{50\%}$ is `r if(n_models==3){Ref_pts_mod3[15,2]}` mt.

\FloatBarrier

<!-- ***********BEGIN EXECUTIVE SUMMARY REFERENCE POINT TABLES************* -->
```{r, results='asis'}
   # Print reference point tables
   if(n_models >= 1) {
     print(Ref_pts_mod1.table, include.rownames = FALSE, caption.placement = 'top',
           sanitize.text.function = function(x){x})
   }

   if(n_models >= 2) {
     print(Ref_pts_mod2.table, include.rownames = FALSE, caption.placement = 'top',
           sanitize.text.function = function(x){x})
   }

   if(n_models == 3) {
     print(Ref_pts_mod3.table, include.rownames = FALSE, caption.placement = 'top',
           sanitize.text.function = function(x){x})
   }
```
<!-- ***********END EXECUTIVE SUMMARY REFERENCE POINT TABLES*************** --> 

\FloatBarrier




##Management Performance{-}
\hl{Include: catches in comparison to OFL, ABC and OY/ACL values for the most 
recent 10 years (when available), overfishing levels, actual catch and discard. 
Include OFL(encountered), OFL(retained) and OFL(dead) if different due to discard 
and discard mortality.}     

Management performance table: Table \ref{tab:mnmgt_perform}


<!-- ***********BEGIN EXECUTIVE SUMMARY MANAGEMENT PERFORMANCE TABLE******* --> 
```{r, results='asis'}
    # Print management performance table - will have to edit the text file and 
    # R code for this table
    # Edit file: './txt_files/Exec_mngmt_performance.csv'
    print(mngmnt.table, include.rownames = FALSE, caption.placement = 'top', 
          sanitize.text.function = function(x){x}, scalebox = .9)
```
<!-- ***********END EXECUTIVE SUMMARY MANAGEMENT PERFORMANCE TABLE********* -->




##Unresolved Problems And Major Uncertainties{-}
   TBD after STAR panel

\FloatBarrier




##Decision Table(s) (groundfish only){-}    
\hl{Include: projected yields (OFL, ABC and ACL), spawning biomass, and stock 
depletion levels for each year. Not required in draft assessments undergoing review.}
    
OFL projection table: Table \ref{tab:OFL_projection}    

Decision table(s) Table \ref{tab:Decision_table_mod1}, 
                  Table \ref{tab:Decision_table_mod2}, 
                  Table \ref{tab:Decision_table_mod3}
 
    Yield curve: Figure \ref{fig:Yield_all}

<!-- ***********BEGIN EXECUTIVE SUMMARY OFL AND DECISION TABLES************ -->
```{r, results='asis'}   
    # Print OFL table 
      print(OFL.table, include.rownames = FALSE, caption.placement = 'top')

   # Decision tables currently read in as txt files and will need to be changed
   # Decision table text set up for alternate states of natural mortality, but 
   # the text can be changed in the Decision Table section of the R file, 
   # R_exec_summary_figs_tables.R
   # Edit text file(s): ./txt_files/DecisionTable_mod1 ,  
   # ./txt_files/DecisionTable_mod1 , and
   # ./txt_files/DecisionTable_mod3
    # print Model 1 decision table
    print(decision_mod1.table, add.to.row = addtorow, include.rownames = FALSE, 
          caption.placement = 'top', 
          hline.after = c(-1, 0, 10, 20, 30, nrow(decision_mod1.table)), 
          scalebox = .85)

if(n_models >= 2) {
    # Print Model 2 decision table
    print(decision_mod2.table, add.to.row = addtorow, include.rownames = FALSE, 
          caption.placement = 'top', 
          hline.after = c(-1, 0, 10, 20, 30, nrow(decision_mod2.table)), 
          scalebox = .85)
}
    
if(n_models ==3) {    
    # Print Model 3 decision table
    print(decision_mod3.table, add.to.row = addtorow, include.rownames = FALSE, 
         caption.placement = 'top',
         hline.after = c(-1, 0, 10, 20, 30, nrow(decision_mod3.table)), 
         scalebox = .9)
}
```
<!-- ***********END EXECUTIVE SUMMARY OFL AND DECISION TABLES************** -->



<!-- ***********BEGIN EXECUTIVE SUMMARY RESULTS SUMMARY TABLE --> 
```{r, results='asis'}
   # Print the results summary table, will have to edit the R code and input file 
   # depending on the stock structure
   # Edit file: ./txt_files/Exec_basemodel_summary.csv and the Summary Results 
   # section in R code R_exec_summary_figs_tables.R

if(n_models == 1){   
 print(base_summary.table, 
       include.rownames = FALSE, 
       caption.placement = 'top',
       floating.environment = 'sidewaystable', 
       sanitize.text.function = function(x){x}, 
       scalebox = .6, 
       align = TRUE, 
       hline.after = c(-1, 0, 4, 5, 7, 9, 11, nrow(base_summary.table)))
}

if(n_models == 2){
 print(base_summary.table, 
       include.rownames = FALSE, 
       caption.placement = 'top',
       floating.environment = 'sidewaystable', 
       sanitize.text.function = function(x){x}, 
       scalebox = .6, 
       align = TRUE, 
       hline.after = c(-1, 0, 4, 13, nrow(base_summary.table)))
}

if(n_models == 3){
  print(base_summary.table, 
        include.rownames = FALSE, 
        caption.placement = 'top',
        floating.environment = 'sidewaystable', 
        sanitize.text.function = function(x){x}, 
        scalebox = .6, 
        align = TRUE, 
        hline.after = c(-1, 0, 4, 13, 22, nrow(base_summary.table)))
}
```

<!-- ***********Yield curve table****************************************** -->
```{r, results='asis'}
   # Select the file to use for the yield curve depending on the number of models
   if(n_models == 1) {
     yield.file  = 'r4ss/plots_mod1/yield1_yield_curve.png'
    } else {
     yield.file  = 'r4ss/plots_compare/yield_comparison_3_models.png'
   }
```
<!-- ***********Edit caption based on fixed params************************* -->

![Equilibrium yield curve for the base case model. Values are based on the `r Dat_end_mod1` fishery selectivity and with steepness fixed at... \label{fig:Yield_all}](`r yield.file`)

<!-- ***********END EXECUTIVE SUMMARY RESULTS SUMMARY TABLE AND YIELD CURVE -->

\FloatBarrier

\newpage

##Research And Data Needs{-}
\hl{Include: identify information gaps that seriously impede the stock assessment.}    

We recommend the following research be conducted before the next assessment:

\begin{enumerate}

\item List item No. 1 in the list

\item List item No. 2 in the list, etc.

\end{enumerate}

##Rebuilding Projections{-}
\hl{Include: reference to the principal results from rebuilding analysis if the 
stock is overfished. This section should be included in the Final/SAFE version 
assessment document but is not required for draft assessments undergoing review. 
See Rebuilding Analysis terms of reference for detailed information on 
rebuilding analysis requirements.}

\FloatBarrier

<!--************RESET FIGURE & TABLE NUMBERS FOR THE DOCUMENT'S MAIN BODY** -->
\newpage
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thetable}{\arabic{table}}
\setcounter{figure}{0}
\setcounter{table}{0}

<!-- ***********INTRODUCTION SECTION*************************************** -->

#Introduction

##Basic Information
`r spp` (\emph{`r spp.sci`}) are most abundant in the Gulf of Alaska, and have been
observed off of Japan, in the Bering Sea, and south to Baja California, although they are sparse south of
Oregon and rare in southern California. While genetic studies have found three populations of `r spp` off of
British Columbia [@seeb_genetic_1988; @withler_co-existing_2001] with, notably, a separate stock off of Vancouver Island, no
significant genetic differences have been found in the range covered by this assessment. `r spp`
show dimorphic growth, with females reaching a slightly large size than males. Males and females
are equally abundant on rearing grounds at age 1.5.

The `r spp` population has been modeled as a single stock off of the U.S. West Coast
(essentially northern California to the Canadian border, since `r spp` are seen extremely
rarely in central and southern California). Good recruitments show up in size-composition data
throughout all portions of this area, which supports the single stock hypothesis. This assessment includes
landings and catch data for `r spp` from the states of Washington, Oregon and California,
along with records from foreign fisheries, the at-sea hake fleet, and surveys.

Prior to 1966, the `r spp` resource off of the northern portion of the U.S. West Coast was
harvested almost entirely by Canadian and United States vessels. Harvest was negligible prior to 1940,
reached \hl{1,000} mt in 1951, \hl{3,000} mt in 1961 and exceeded \hl{7,000} mt in 1965. Catches increased
dramatically after 1965, with the introduction of large distant-water fishing fleets from the Soviet Union
and Japan. Both nations employed large factory stern trawlers as their primary method for harvesting
Pacific ocean perch. Peak removals by all foreign nations combined are estimated at over \hl{15,000} mt in
1966 and remained over \hl{12,000} mt in 1967. These numbers are based upon a re-analysis of the foreign
catch data [@rogers_species_2003], which focused on deriving a more realistic species composition for catches
previously identified only as `r spp`. Catches declined rapidly following these peak years,
and `r spp` stocks were considered to be severely depleted throughout the Oregon-Vancouver Island region by 1969 
[@gunderson_population_1977; @gunderson_status_1977]. Landed harvest averaged \hl{1,500} mt over the period 1977-94. 
Landings have continued to decline since 1994, primarily due to more restrictive management.

Prior to 1977, `r spp` in the northeast Pacific were managed by the Canadian
Government in its waters and by the individual states in waters off of the United States. With
implementation of the Magnuson Fishery Conservation and Management Act (MFCMA) in 1977, U.S.
territorial waters were extended to 200 miles from shore, and primary responsibility for management of
the groundfish stocks off Washington, Oregon and California shifted from the states to the Pacific Fishery
Management Council (PFMC) and the National Marine Fisheries Service (NMFS). At that time, however,
a Fishery Management Plan (FMP) for the west coast groundfish stocks had not yet been approved. In the
interim, the state agencies worked with the PFMC to address conservation issues. In 1981, the PFMC
adopted a management strategy to rebuild the depleted Pacific ocean perch stocks to levels that would
produce Maximum Sustainable Yield (MSY) within 20 years. On the basis of cohort analysis [@gunderson_results_1978], 
the PFMC set Acceptable Biological Catch (ABC) levels at 600 mt for the US portion of the
Vancouver INPFC area and 950 mt for the Columbia INPFC area. To implement this strategy, the states
of Oregon and Washington each established landing limits for Pacific ocean perch. Trawl trip limits of
various forms remained in effect through 2010 (\hl{Table 1}).

Age estimates for `r spp` prior to the 1980s were made via surface ageing of otoliths, which
misses the very tight annuli at the edge of the otolith once the fish reaches near maximum size. Ages are
biased by around age 10-12, and maximum age was estimated to be in the 20s, which lead to an
overestimate of the natural mortality rate and the productivity of the stock. Using break and burn
methods, `r spp` have been aged to over 100 years, and we now know that the underlying
assumptions of the early models were overly optimistic about productivity.
Research surveys have been used to provide fishery-independent information about the abundance,
distribution, and biological characteristics of `r spp`. A coast-wide survey of the rockfish
resource was conducted in 1977 [@gunderson_distribution_1980] and was repeated every three years
through 2004. The National Marine Fisheries Service (NMFS) coordinated a cooperative research survey
of the `r spp` stocks off Washington and Oregon with the Washington Department of
Fisheries (WDFW) and the Oregon Department of Fish and Wildlife (ODFW) in March-May 1979
[@wilkins_condition_1983]. This survey was repeated in 1985. Two slope surveys have been conducted
on the west coast in recent years, one using the research vessel Miller Freeman, which ended in 2001, and
another ongoing cooperative survey using commercial fishing vessels which began in 1998 as a DTS
(Dover sole, thornyhead and sablefish) survey, was expanded to other groundfish in 1999. In 2003, this
survey was expanded spatially to include the shelf. This last survey, conducted by the NWFSC, continues
to cover depths from 30-700 fathoms (55-1280 meters) on an annual basis.

##Map
A map showing the scope of the assessment and depicting boundaries for fisheries or 
data collection strata is provided in Figure \ref{fig:boundary_map}.

##Life History
\hl{Include: Important features of life history that affect management (e.g., migration, 
sexual dimorphism, bathymetric demography).}

##Ecosystem Considerations
\hl{Include: Ecosystem considerations (e.g., ecosystem role and trophic relationships of 
the species, habitat requirements/preferences, relevant data on ecosystem processes 
that may affect stock or parameters used in the stock assessment, and/or cross-FMP 
interactions with other fisheries). This section should note if environmental 
correlations or food web interactions were incorporated into the assessment model. 
The length and depth of this section would depend on availability of data and reports 
from the IEA, expertise of the STAT, and whether ecosystem factors are informational 
to contribute quantitative information to the assessment.}



##Fishery Information
\hl{Include: Important features of current fishery and relevant history of fishery.}



##Summary of Management History
\hl{Include: Summary of management history (e.g., changes in mesh sizes, trip 
limits, or other management actions that may have significantly altered selection, 
catch rates, or discards).}


##Management Performance
\hl{Include: Management performance, including a table or tables comparing 
Overfishing Limit (OFL), Annual Catch Limit (ACL), Harvest Guideline (HG) 
[CPS only], landings, and catch (i.e., landings plus discard) for each area and year.}

Management performance table: (Table \ref{tab:mnmgt_perform})      
A summary of these values as well as other base case summary results can be found 
in Table \ref{tab:base_summary}.


##Fisheries off Canada, Alaska, and/or Mexico
Include if necessary.

<!-- ************ASSESSMENT SECTION**************************************** -->
#Assessment

##Data
Data used in the `r spp` assessment are summarized in Figure \ref{fig:data_plot}.  
A description of each data source is below.


<!-- ************FISHERY-DEPENDENT DATA************************************ -->
###Commercial Fishery Landings

**Washington**

Historical commercial fishery landigns of `r spp` from Washington for the years 1918-1980 were obtained from Theresa Tsou (WDFW) and Phillip Weyland (WDFW).  This assessment is the first `r spp` assessment to include a state provide historical catch reconstruction and hence, the historical catches for Washington vary markedly from those used in the 2011 assessment.  Recent landings (1981-2016) were obtained from PacFIN (Pacific Fisheries Information Network (PacFIN) retrieval dated \hl{March 3, 2015}, Pacific States Marine Fisheries Commission, Portland, Oregon; www.psmfc.org).

**Oregon**

Historical commercial fishery landings of `r spp` from Oregon for the years 1892-1986 were obtained from Alison Dauble (ODFW). A description of the methods can be found in [@karnowski_historical_2014]. Recent landings (1987-2016) were obtained from PacFIN (Pacific Fisheries Information Network (PacFIN) retrieval dated \hl{March 3, 2015}, Pacific States Marine Fisheries Commission, Portland, Oregon; www.psmfc.org).

**California**

Historical commercial fishery landings of `r spp` were obtained from the online database of the California Cooperative Groundfish Survey, also known as CALCOM (128.114.3.187) for the years 1916-1980. A description of the methods can be found in [@ralston_documentation_2010]. Recent landings  (1981-2016) were obtained from PacFIN (Pacific Fisheries Information Network (PacFIN) retrieval dated \hl{March 3, 2015}, Pacific States Marine Fisheries Commission, Portland, Oregon; www.psmfc.org).

**At-sea fishery**

Catches of `r spp` are monitored aboard the vessel by observers in the At-Sea hake Observer program (ASHOP) and were available for the years of 1975-2016. Observers use a spatial sample design, based on weight, to randomly choose a portion of the haul to sample for species composition. For the last decade, this is typically 30-50% of the total weight. The total weight of the sample is determined by all catch passing over a flow scale. All species other than hake are removed and weighed, by species, on a motion compensated flatbed scale. Observers record the weights of all non-hake species. Non-hake species total weights are expanded in the database by using the proportion of the haul sampled to the total weight of the haul. The catches of non-hake species in unsampled hauls is determined using bycatch rates determined from sampled hauls. Since 2001, more than 97% of the hauls have been observed and sampled.

**Foreign**

From the 1960s through the early 1970s, foreign trawling enterprises harvested considerable amounts of rockfish off Washington and Oregon, and along with the domestic trawling fleet, landed large quantities of 'r spp'. Foreign catches of individual species were estimated by @rogers_species_2003 and attributed to INPFC areas for the years of 1966-1976 for 'r spp'. The foreign catches were combined across areas for a coastwide removal total.

**Discards**


###Abundance Indices

**Sub-heading 1**

**Sub-heading 2**



<!-- ************FISHERY-INDPENDENT DATA*********************************** -->

###Fishery-Independent Data: possible sources

**Northwest Fisheries Science Center (NWFSC) shelf-slope survey**

The NWFSC shelf-slope survey is based on a random-grid design; covering the coastal waters from a depth of 55 m to 1,280 m [@bradburn_2003_2011]. This design uses four chartered industry vessels in most years, assigned to a roughly equal number of randomly selected grid cells. The survey, which has been conducted from late-May to early-October each year, is divided into two 2-vessel passes of the coast, which are executed from north to south. This design therefore incorporates both vessel-to-vessel differences in catchability as well as variance associated with selecting a relatively small number (~700) of cells from a very large population of possible cells (greater than 11,000) distributed from the Mexican to the Canadian border. 

**Northwest Fisheries Science Center (NWFSC) slope survey**   

The NWFSC slope survey covered waters throughout the summer from 183 m to 1280 m north of $34^\circ 30^\prime$ S, which is near Point Conception. The survey strata used to expand the biomass data for this assessment are shown in \hl{Table 5}. 


**Alaska Fisheries Science Center (AFSC) slope survey**   

The AFSC slope survey operated during autumn (October-November) aboard the R/V Miller Freeman. Partial survey coverage of the U.S. west coast occurred during 1988-96 and complete coverage (north of $34^\circ 30^\prime$ S) during 1997, 1999, 2000, and 2001. Only the four years of consistent and complete surveys plus 1996, which surveyed north of $43^\circ$ N latitude to the U.S.-Canada border, were used in this assessment. The number of tows ranged from \hl{8 in 2001 to 26 in 1996 (Table 7)}. The numbers of tows with length data for 'r spp' are also shown in \hl{Table 7}. \hl{Because a large number of positive tows occurred in 1996}, it was decided to include that year, which surveyed from $43^\circ$ N latitude to the U.S.-Canada border. Therefore, only tows from $43^\circ$ N latitude to the U.S.-Canada border were used.

**Triennial Bottom Trawl Survey**

The triennial survey was first conducted by the AFSC in 1977 and spanned the timeframe from 1977-2004. The survey's design and sampling methods are most recently described in [@weinberg_estimation_2002]. Its basic design was a series of equally-spaced transects from which searches for tows in a specific depth range were initiated \hl{(Figure 5)}. The survey design has changed slightly over the period of time \hl{(Table 4, Figure 3)}. In general, all of the surveys were conducted in the mid-summer through early fall: the 1977 survey was conducted from early July through late September; the surveys from 1980 through 1989 ran from mid-July to late September; the 1992 survey spanned from mid-July through early October; the 1995 survey was conducted from early June to late August; the 1998 survey ran from early June through early August; and the 2001 and 2004 surveys were conducted in May-July \hl{(Figure 4)}.

Haul depths ranged from 91-457 m during the 1977 survey with no hauls shallower than 91 m. The surveys in 1980, 1983, and 1986 covered the West Coast south to $36.8^\circ$ N latitude and a depth range of 55-366 meters. The surveys in 1989 and 1992 covered the same depth range but extended the southern range to $34.5^\circ$ N (near Point Conception). From 1995 through 2004, the surveys covered the depth range 55-500 meters and surveyed south to $34.5^\circ$ N. In the final year of the triennial series (2004), the NWFSC's Fishery Resource and Monitoring division (FRAM) conducted the survey and followed very similar protocols as the AFSC.

Given the different depths surveyed during 1977, the data from that year were not included in this assessment. Water hauls [@zimmermann_influence_2003] and tows located in Canadian waters were also excluded from the analysis of this survey. The survey was analyzed as an early series (1980-1992) and a late series (1995-2004), as has been done in other West Coast rockfish assessments.

**Pacific ocean perch Survey**


**Pikitch Study** 

The Pikitch study was conducted between 1985 and 1987 [@pikitch_evaluation_1988].  The northern 
and southern boundaries of the study were $48^\circ 42^\prime$ N latitude and 
$42^\circ 60^\prime$ N. latitude respectively, which is primarily within the 
Columbia INPFC area [@pikitch_evaluation_1988 ; @rogers_numerical_1992].  Participation in the study 
was voluntary and included vessels using bottom, midwater, and shrimp trawl gears.  
Observers of normal fishing operations on commercial vessels collected the data, 
estimated the total weight of the catch by tow and recorded the weight of species 
retained and discarded in the sample.  
 

<!--************BIOLOGICAL DATA*********************************************-->
###Biological Parameters and Data

**Length And Age Compositions**

Include: Sample size information for length and age composition data by area, 
year, gear, market category, etc., including both the number of trips and 
fish sampled.

Length compositions were provided from the following sources, by region, with 
brief descriptions below:    

_Model 1_ 
\begin{itemize}[noitemsep,nolistsep,topsep=0pt]
  \item Source No. 1 (\emph{ex. research, commerical dead fish, live fish, etc},\\     
        date range (ex. 2010-2011)
  \item Source No. 2 (\emph{ex. research, commerical dead fish, live fish, etc},\\      
        date range (ex. 2010-2011) 
  \item etc...      
  \item Begin sublist if desired 
    \begin{itemize}[noitemsep,nolistsep]
      \item Sublist source No. 1     
      \item Sublist source No. 2        
      \item etc...     
    \end{itemize}
  \item Back to main list, next Source     
  \item Last Source     
\end{itemize}

Can duplicate this list if you have more than one assessment model

Possible sources of age and length data:

*Recreational: Washington (WDFW)*

*Recreational: California MRFSS And CRFS Length Composition Data*
Individual fish lengths recorded by MRFSS (1980-2003) and CRFS (2004-2011) samplers were
downloaded from the RecFIN website (www.recfin.org). CRFS data from 2012-2014 were
obtained directly from CDFW.

*Recreational: Oregon Recreational Boat Survey (ORBS)*
Biological data from the ORBS program were provided by ODFW. The ORBS is a dockside
sampling program for the both the recreational CPFV and private modes. Length composition
samples from north of Florence for the CPFV and private fleets were provided from
1980-2014.  Samples from south of Florence spanned 1984-2014


*Recreational: Miller and Gotshall [-@Miller1965]*      
The Northern California Marine Sport Fish Survey conducted an assessment survey with
goals that included estimation of annual fishing effort by all recreational fishing modes,
catch by weight, CPUE, and collection of data to analyze length compositions


*Commercial: PacFIN (Oregon and California)*



*Research: NMFS Groundfish Ecology Survey*      

From 2001-2005, the SWFSC Fisheries Ecology Division conducted longline surveys 
aboard a chartered commercial longline vessel at various stations between 
Monterey and Davenport, CA ($36^\circ$ N. latitude to $37.5^\circ$ N. latitude)
(pers. comm. Don Pearson, SWFSC). Longline gear was set in various depths from 
10 meters to 700 meters, parallel to the depth contour.  Each longline set 
consisted of 3-5 skates, each with about 250 2/0 circle hooks baited with squid.  
In nearshore habitats, the gear soaked for roughly 30 minutes.  

*Research: California Collaborative Fisheries Research Program (CCFRP)*

*Research: NWFSC shelf-slope survey*

*Research: NWFSC slope survey*

*Research: Abrams Thesis*




\vspace{.5cm}
**Age Structures**

Age structure data were available from the following sources:

_Model Region 1_ 
\begin{itemize}[noitemsep,nolistsep,topsep=0pt]
  \item Source No. 1 (\emph{ex. research, commericla dead fish, live fish, etc},\\ 
        date range (ex. 2010-2011)
  \item Source No. 2 (\emph{ex. research, commericla dead fish, live fish, etc},\\
        date range (ex. 2010-2011) 
  \item etc...      
  \item Begin sublist if desired 
    \begin{itemize}[noitemsep,nolistsep]
      \item Sublist source No. 1     
      \item Sublist source No. 2        
      \item etc...     
    \end{itemize}
  \item Back to main list, next Source     
  \item Last Source     
\end{itemize}

Can duplicate this list if you have more than one assessment model

Length-at-age was initially estimated external to the population dynamics models 
using the von Bertalanffy growth curve [@vonB1938], $L_i = L_{\infty}e^{(-k[t-t_0])}$, 
where $L_i$ is the length (cm) at age $i$, $t$ is age in years, $k$ is rate of 
increase in growth, $t_0$ is the intercept, and $L_{\infty}$ is the asymptotic length.  



\vspace{.5cm}
**Aging Precision And Bias**




\vspace{.5cm}
**Weight-Length**

The weight-length relationship is based on the standard power function: 
$W = \alpha(L^\beta)$ where $W$ is individual weight (kg), $L$ is length (cm), 
and $\alpha$ and $\beta$ are coefficients used as constants.



\vspace{.5cm}
**Maturity And Fecundity**



\vspace{.5cm}
**Natural Mortality**

Natural mortality for wild fish populations is extremely difficult to estimate.  



\vspace{.5cm}
**Sex ratios**



###Environmental Or Ecosystem Data Included In The Assessment






<!-- ***********HISTORY AND CURRENT ASSESSMENT***************************** -->
##History Of Modeling Approaches Used For This Stock

###Previous Assessments

###Previous Assessment Recommendations
Include: Response to STAR panel recommendations from the most recent previous 
assessment.

\begin{description}[style=unboxed]

  \item[Recommendation 1: blah blah blah.] \hfill \\

   STAT response: blah blah blah....

\item[Recommendation 2: blah blah blah.] \hfill \\

  STAT response: blah blah blah....

\item[Recommendation 3: blah blah blah., etc.] \hfill \\

  STAT response: Continue recommendations as needed


\end{description}




<!-- ************************MODEL DESCRIPTION***************************** -->
##Model Description


###Transition To The Current Stock Assessment
Include: Complete description of any new modeling approaches

Below, we describe the most important changes made since the last full assessment 
and explain rationale for each change.:

1. Change No. 1. \emph{Rationale}: blah blah blah.

2. Change No. 2.  \emph{Rationale}: blah blah blah.

3. Change No. 3.  \emph{Rationale}:  Continue list as needed.



###Definition of Fleets and Areas
We generated data sources for each of the models.  Fleets by model include:


**Model Region 1 or remove this line if only one model** 

\emph{Commercial}: The commercial fleets include...   

\emph{Recreational}: The recreational fleets include...

\emph{Research}: Research derived-data include...



###Summary of Data for Fleets and Areas



###Modeling Software
The STAT team used Stock Synthesis 3 version 3.24u by Dr. Richard Methot at 
the NWFSC. This most recent version (SS-V3.24u) was used, since it included 
improvements and corrections to older versions.

###Data Weighting
Citation for Francis method [@Francis2011]      
Citation for Ianelli-McAllister harmonic mean method [@McAllister1997]



###Priors
Citation for Hamel prior on natural mortality [@hamel_method_2015]


###General Model Specifications
Citation for posterior predictive fecundity relationship from Dick [-@dick_modeling_2009] and [-@dick_meta-analysis_2017]     
Model data, control, starter, and forecast files can be found in Appendices A-D.


###Estimated And Fixed Parameters
A full list of all estimated and fixed parameters is provided in Tables....
Estimated and fixed parameters tables currently read in from .csv file, 
EXAMPLE: Table \ref{tab:Model1_params}


##Model Selection and Evaluation
###Key Assumptions and Structural Choices
Include: Evidence of search for balance between model realism and parsimony.  
Comparison of key model assumptions, include comparisons based on nested models 
(e.g., asymptotic vs. domed selectivities, constant vs. time-varying selectivities).  



###Alternate Models Considered
Include: Summary of alternate model configurations that were tried but rejected.



###Convergence
Include: Randomization run results or other evidence of search for global 
best estimates.    

Convergence testing through use of dispersed starting values often requires 
extreme values to actually explore new areas of the multivariate likelihood 
surface. Jitter is a SS option that generates random starting values from a 
normal distribution logistically transformed into each parameter's range 
[@methot_stock_2013]. Table \ref{tab:jitter} shows the results of running 100 jitters 
for each pre-STAR base model....

##Response To The Current STAR Panel Requests
\begin{description}[style=unboxed]

\item[Request No. 1: Add after STAR panel.] \hfill \\

    \textbf{Rationale:} Add after STAR panel.  

    \textbf{STAT Response:} Add after STAR panel.

\item[Request No. 2: Add after STAR panel.] \hfill \\

    \textbf{Rationale:} Add after STAR panel.

    \textbf{STAT Response:} Add after STAR panel.

\item[Request No. 3: Add after STAR panel.] \hfill \\

    \textbf{Rationale:} Add after STAR panel.
  
    \textbf{STAT Response:} Add after STAR panel.

\item[Request No. 4: Example of a request that may have a list:] \hfill \\
\begin{itemize}
\item \textbf{Item No. 1}
\item \textbf{Item No. 2}
\item \textbf{Item No. 3, etc.}
\end{itemize}

    \textbf{Rationale:} Add after STAR panel.

    \textbf{STAT Response:} Continue requests as needed.


\end{description}

<!-- *********************MODEL 1 RESULTS********************************** -->
##Model 1 
###Model 1 Base Case Results

Table \ref{tab:Model1_params}   



### Model 1 Uncertainty and Sensitivity Analyses
Table \ref{tab:Sensitivity_model1}



### Model 1 Retrospective Analysis
 

### Model 1 Likelihood Profiles


###Model 1 Harvest Control Rules (CPS only)

###Model 1 Reference Points (groundfish only)
Intro sentence or two....(Table \ref{tab:Timeseries_mod1}). 

Equilibrium yield at the proxy $F_{MSY}$ harvest rate corresponding to 
$SPR_{50\%}$ is `r Ref_pts_mod1[15,2]` mt.  Table \ref{tab:Ref_pts_mod1} 
shows the full suite of estimated reference points for the northern area model 
and Figure \ref{fig:Yield_all} shows the equilibrium yield curve.


<!-- *************************MODEL 2 RESULTS****************************** -->
##Model 2 

###Model 2 Base Case Results

### Model 2 Uncertainty and Sensitivity Analyses

### Model 2 Retrospective Analysis

### Model 2 Likelihood Profiles

###Model 2 Harvest Control Rules (CPS only)

###Model 2 Reference Points (groundfish only)


<!-- ***********************MODEL 3 RESULTS******************************** -->
##Model 3

###Model 3 Base Case Results

### Model 3 Uncertainty and Sensitivity Analyses

### Model 3 Retrospective Analysis

### Model 3 Likelihood profiles

###Model 3 Harvest Control Rules (CPS only)

###Model 3 Reference Points (groundfish only)


<!-- **************HARVEST PROJECTIONS AND DECISION TABLE****************** -->
#Harvest Projections and Decision Tables
Table \ref{tab:mnmgt_perform}

**Model 1 Projections and Decision Table (groundfish only)**
(Table \ref{tab:Forecast_mod1} 

Table \ref{tab:Decision_table_mod1}

**Model 2 Projections and Decision Table (groundfish only)** 

**Model 3 Projections and Decision Table (groundfish only)**


<!-- **************************REGIONAL MANAGEMENT************************* -->
#Regional Management Considerations
1.  For stocks where current practice is to allocate harvests by management 
area, a recommended method of allocating harvests based on the distribution 
of biomass should be provided.  The MT advisor should be consulted on the 
appropriate management areas for each stock.
2.  Discuss whether a regional management approach makes sense for the species 
from a biological perspective.
3.  If there are insufficient data to analyze a regional management approach,
what are the research and data needs to answer this question?



<!-- ****************************RESEARCH NEEDS**************************** -->
#Research Needs
\begin{enumerate}

\item Research need No. 1

\item Research need No. 2

\item Research need No. 3

\item etc.

\end{enumerate}


<!-- ***************************ACKNOWLEDGEMENTS*************************** -->
#Acknowledgments
Include: STAR panel members and affiliations as well as names and affiliations 
of persons who contributed data, advice or information but were not part of the 
assessment team. Not required in draft assessment undergoing review.


\newpage
\FloatBarrier

<!-- ====================================================================== -->
<!-- ****************************            ****************************** --> 
<!-- ****************************BEGIN TABLES****************************** --> 
<!-- ****************************             ***************************** --> 
<!-- ======================================================================--> 

#Tables

<!-- ********************************************************************** --> 
<!-- *********************Commercial landings TABLES*********************** --> 
<!-- ********************************************************************** --> 




<!-- ********************************************************************** --> 
<!-- *******************Commercial Discards TABLES************************* --> 
<!-- ********************************************************************** --> 





<!-- ********************************************************************** --> 
<!-- ***********Recreational Landings and discards TABLES****************** --> 
<!-- ********************************************************************** --> 




<!-- ********************************************************************** --> 
<!-- ************Oregon commercial logbook TABLES ************************* --> 
<!-- ********************************************************************** --> 



<!-- ********************************************************************** --> 
<!-- ************Recreational dockside survey TABLES*********************** --> 
<!-- ********************************************************************** --> 



<!-- ********************************************************************** -->
<!-- ************Recreational onboard observer index TABLES**************** -->
<!-- ********************************************************************** -->




<!-- ********************************************************************** -->
<!--  ************Fishery dependent biological sampling TABLES************* -->
<!-- ********************************************************************** -->

```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/FisheryLength_N.csv')
      colnames(Fish_Length) = c('Year',
                                  'Trips',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of commercial fishery length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/POPLengthSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of Pacific ocean perch survey length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/TriennialLengthSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of Triennial survey length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```

```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/AFSCLengthSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of AFSC slope survey length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/NWFSCSlopeLengthSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of NWFSC slope survey length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/NWFSCComboLengthSampleSize.csv')
    Fish_Length = Fish_Length[,2:ncol(Fish_Length)]
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of NWFSC shelf/slope survey length samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```



```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/FisheryAges_N.csv')
      colnames(Fish_Length) = c('Year',
                                  'Trips',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of commercial fishery age samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/POPAgeSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of Pacific ocean perch survey age samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/TriennialAgeSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of Triennial survey age samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/NWFSCSlopeAgeSampleSize.csv')
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of NWFSC slope survey age samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```


```{r, results = 'asis'}
    Fish_Length = read.csv('C:/Assessments/POP2017/WriteUp/Tables/NWFSCComboAgeSampleSize.csv')
    Fish_Length = Fish_Length[,2:ncol(Fish_Length)]
      colnames(Fish_Length) = c('Year',
                                  'Tows',
                                  'Fish',
                                  'Sample Size')

   # Index of abundance summary, create table   
     Fish_Length.table = xtable(Fish_Length, 
                                  caption = c('Summary of NWFSC shelf/slope survey age samples used in the stock assessment.'),
                                 label = 'tab:Comm_Lengths',
                                 digits = 0)    
    # Add alignment  
      align(Fish_Length.table) = c('l',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{.75in}',
                                     '>{\\centering}p{1in}')  
    
    # Print commercial length sample numbers
      print(Fish_Length.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
    # NEED TO FIGURE OUT HOW TO APPLY LONGTABLE HERE
      
```

\FloatBarrier




<!-- ====================================================================== --> 
<!-- ******************START BIOLOGICAL DATA TABLES************************ --> 
<!-- ====================================================================== --> 




<!-- ********************************************************************** -->
<!-- ***********************Weight-length TABLES*************************** --> 
<!-- ********************************************************************** -->




<!-- ********************************************************************** --> 
<!-- ******************Maturity and Fecundity TABLES*********************** --> 
<!-- ********************************************************************** --> 





<!-- ********************************************************************** -->
<!-- **********************Age Structure TABLES**************************** --> 
<!-- ********************************************************************** -->






\FloatBarrier

<!-- ====================================================================== -->
<!-- ********************BASE-CASE MODEL 1 TABLES************************** --> 
<!-- **REPEAT THIS SECTION AND EDIT AS NEEDED IF YOU HAVE MULTIPLE MODELS** --> 
<!-- ====================================================================== -->



<!-- ***********MODEL 1 PARAMETERS***************************************** --> 
\begin{landscape}
```{r, results='asis'}
       # If you use this for more than one model = change mod1 to mod2 or mod3
    mod_params = mod1$parameters[-c(grep('Recr',mod1$parameters$Label),
                                         grep('Impl',mod1$parameters$Label)),
                                      (names(mod1$parameters) %in%
                                         c("Num","Label","Value","Phase","Min",
                                           "Max","Status","Parm_StDev",
                                           "PR_type","Prior","Pr_SD"))]  

    # Combine bounds into one column
    mod_params$Min = paste('(', mod_params$Min, ', ', mod_params$Max, ')', sep='')
    
    
    # Combine prior info to one column
    #mod_params$PR_type = gsub('No_prior', 'None', mod_params$PR_type)
    mod_params$PR_type = ifelse(mod_params$PR_type == 'No_prior' , 'None',
                                paste(mod_params$PR_type,' (', mod_params$Prior, 
                                      ', ', mod_params$Pr_SD, ')', sep = ''))
    
    # Remove the max, prior and prior sd columns
    drops = c('Max', 'Prior', 'Pr_SD')
    mod_params = mod_params[, !(names(mod_params) %in% drops)]
    
    # Add column names
    colnames(mod_params) = c('No.',
                             'Parameter',
                             'Value',
                             'Phase',
                             'Bounds',
                             'Status',
                             'SD',
                             'Prior (Exp.Val, SD) ')

    # Model 1 model parameters
    mod_params.table = xtable(mod_params, 
                              caption=c(paste('List of parameters used in
                                              the base model, including estimated 
                                              values and standard deviations (SD), 
                                              bounds (minimum and maximum), 
                                              estimation phase (negative values indicate
                                              not estimated), status (indicates if 
                                              parameters are near bounds, and prior type
                                              information (mean, SD).'
                                              , sep='')), 
                              label='tab:model_params',
                              digits = c(0,0,0,3,0,3,0,3,0))  

    # Add alignment  
    align(mod_params.table) = c('lrlrrcccl')
        # Add alignment  
     # align(mod_params.table) = c('l',
    #                                 '>{\\raggedright}p{.4in}',
    #                                 '>{\\raggedright}p{.8in}',
    #                                 '>{\\centering}p{.3in}',
    #                                 '>{\\centering}p{.3in}',
    #                                 '>{\\centering}p{.4in}',
    #                                 '>{\\centering}p{.4in}', 
    #                                 '>{\\centering}p{.4in}',
    #                                 '>{\\centering}p{.4in}',
    #                                '>{\\centering}p{.5in}',
    #                                 '>{\\centering}p{.5in}')  
 
    # Add "continued on next page"" footnote   
    addtorow          <- list()
    addtorow$pos      <- list()
    addtorow$pos[[1]] <- c(0)
    addtorow$command  <- c(paste("\\hline \n",
                                 "\\endhead \n",
                                 "\\hline \n",
                                 "\\multicolumn{3}{l}",
                                 "{\\footnotesize Continued on next page} \n",
                                 "\\endfoot \n",
                                 "\\endlastfoot \n",sep=""))



    # Print Model 1 parameters
    print(mod_params.table, 
          include.rownames = FALSE,
          caption.placement = 'top',
          tabular.environment = 'longtable',
          floating = FALSE,
          add.to.row = addtorow)
```
\end{landscape}
<!-- ---------------------------------------------------------------------- -->



\newpage

<!-- ***********Indices of abundance summary table************************* -->
```{r, results = 'asis'}
    Index_summary = read.csv('./txt_files/Index_summary.csv')
      colnames(Index_summary) = c('Region',
                                  'ID',
                                  'Fleet',
                                  'Years',	
                                  'Name',
                                  'Fishery ind.',
                                  'Filtering',
                                  'Method',	
                                  'Endorsed')

   # Index of abundance summary, create table   
     Index_summary.table = xtable(Index_summary, 
                                  caption = c('Summary of the biomass/abundance
                                              time series used in the stock
                                              assessment.'),
                                 label = 'tab:Index_summary',
                                 digits = 0)    
    # Add alignment  
      align(Index_summary.table) = c('l',
                                     '>{\\centering}p{.4in}',
                                     '>{\\centering}p{.3in}',
                                     '>{\\centering}p{.3in}',
                                     '>{\\centering}p{.3in}',
                                     '>{\\centering}p{.6in}',
                                     '>{\\centering}p{.5in}', 
                                     '>{\\centering}p{.8in}',
                                     '>{\\centering}p{.8in}',
                                     '>{\\centering}p{.5in}')  
    
    # Print index summary table
      print(Index_summary.table, 
            include.rownames=FALSE, 
            caption.placement='top',
            sanitize.text.function = function(x){x})
```
<!-- ---------------------------------------------------------------------- -->

\newpage

<!-- ***********JITTER TABLE*********************************************** --> 
```{r, results = 'asis'}
    # Replace values in file and read in - values for all models in 1 table  
      jitter = read.csv('./txt_files/JitterTable.csv')  

    # Create model 1 jitter table
    jitter.table = xtable(jitter, 
                          caption = c('Results from 100 jitters from each of 
                                      the three models.'),
                          label = 'tab:jitter')
    
    # Print jitter table (all models)    
    print(jitter.table, 
          include.rownames = FALSE, 
          caption.placement = 'top')
```
<!-- ---------------------------------------------------------------------- -->

\FloatBarrier

\newpage
<!-- ***********MODEL 1 SENSITIVITY TABLE(S)******************************* --> 
```{r, results = 'asis'}
    
    # Read in/organize sensitivity file, change column names, caption
    Sens_model1 = read.csv('./txt_files/Sensitivities_model1.csv')
    colnames(Sens_model1) = c('Label', 
                              'Base (Francis weights)', 
                              'Harmonic mean weights',
                              'Drop index', 
                              'Drop ages', 
                              'Down-weight lengths',
                              'Free size Age0', 
                              'Free CV Amin', 
                              'External growth')

    # Create sensitivities table
    Sens_model1.table = xtable(Sens_model1, 
                               caption = c('Sensitivity of the base model 
                                          to dropping or down-weighting data 
                                          sources and alternative assumptions 
                                          about growth.'),
                               label = 'tab:Sensitivity_model1', digits = 2)    
  
    # Add alignment - this uses centered aligment of .6 inches for all columns 2+,
    # You can change this easily to have variable columns width after you know how many
    # colunns your final table has
    align(Sens_model1.table) = c('l','l', rep('>{\\centering}p{.6in}', dim(Sens_model1)[2]-1))
                    #             '>{\\centering}p{.6in}',
                    #             '>{\\centering}p{.5in}',
                    #             '>{\\centering}p{.5in}',
                    #             '>{\\centering}p{.6in}', 
                    #             '>{\\centering}p{.5in}',
                    #             '>{\\centering}p{.6in}',
                    #             '>{\\centering}p{.6in}',
                    #             '>{\\centering}p{.6in}')  

    # Print model 1 sensitivity table
    print(Sens_model1.table, 
          include.rownames = FALSE,             
          caption.placement = 'top',
          floating.environment = 'sidewaystable',
          scalebox = .9)

```
<!-- ---------------------------------------------------------------------- -->


\newpage
<!-- ***********MODEL 1 REFERENCE POINTS TIME SERIES TABLE***************** --> 
```{r}
   
    
    # Total biomass, extract and subset
    Bio_all = mod1$sprseries[, c('Year', 'Bio_all')]
    Bio_allyrs = subset(Bio_all, Year > (Dat_start_mod1 - 1) & Year < (LastYR + 1))

  
  
    # Spawning biomass, extract and subset, and turn into scientific notation
    SpawningB = mod1$derived_quants[grep('SPB', mod1$derived_quants$LABEL), ]
    SpawningB = SpawningB[c(-1, -2), ]
    SpawningByrs = SpawningB[SpawningB$LABEL >= paste('SPB_', Dat_start_mod1, sep='') &  
                             SpawningB$LABEL <= paste('SPB_', LastYR, sep=''), ] 
        
        SpawningB_units = ''
        if(mean(SpawningByrs$Value) > 1000000){
            SpawningB_units <- "million"
            SpawningByrs$Value <- SpawningByrs$Value/1000000
         }

    
    # Depletion, extract, rename and subset
    Depl_years = as.data.frame(seq(Dat_start_mod1, LastYR, 1))
    colnames(Depl_years) = 'Year'
    Depl_years$Depl = 0
    Depletion = mod1$derived_quants[grep('Bratio', mod1$derived_quants$LABEL), ]
    Depletionyrs = Depletion[Depletion$LABEL >= paste0('Bratio_', Dat_start_mod1) &  
                             Depletion$LABEL <= paste0('Bratio_', LastYR), ]
    
    Depletionyrs$Year = Depletionyrs$Label1 = substr(Depletionyrs$LABEL,
                                                     (nchar(Depletionyrs$LABEL) + 1) - 4, 
                                                      nchar(Depletionyrs$LABEL))
   # Make sure depletion is numeric and merge ...
   Depletionyrs$Year = as.numeric(Depletionyrs$Year)
   Depleteyrs = merge(Depl_years, Depletionyrs, all.x=T, all.y=T, by.x='Year', by.y='Year')
   Depleteyrs[is.na(Depleteyrs)] <- 0
   Depleteyrs$total = Depleteyrs$Depl + Depleteyrs$Value
    
   # Recruits, extract and subset
   Recruit = mod1$derived_quants[grep('Recr', mod1$derived_quants$LABEL), ]
   Recruit = Recruit[c(-1, -2), ]
   Recruityrs = Recruit[Recruit$LABEL >= paste('Recr_', Dat_start_mod1, sep='') &  
                        Recruit$LABEL <= paste('Recr_', LastYR, sep=''), ]  
    
    
   # Landings/total catch, extract and subset years
   Landings = mod1$sprseries[ , c('Year','Dead_Catch_B')]
   Landingsyrs = subset(Landings, Year > (Dat_start_mod1 - 1) & Year < (LastYR + 1))
    
  
    
   # Relatvie exploitation rate, extract, subset and merge
   Exploit = mod1$derived_quants[grep('F', mod1$derived_quants$LABEL), ]
   Exploit = Exploit[c(-1, -2), ]
   Exploityrs = Exploit[Exploit$LABEL >= paste('F_', Dat_start_mod1, sep = '') &  
                        Exploit$LABEL <= paste('F_', LastYR, sep = ''), ]  
   Exploityrs$Year = Exploityrs$Label1 = substr(Exploityrs$LABEL, 
                                               (nchar(Exploityrs$LABEL) + 1) - 4,
                                                nchar(Exploityrs$LABEL))
   Exploityrs$Year = as.numeric(Exploityrs$Year)
   Exploited = merge(Depl_years, Exploityrs, all.x=T, all.y=T, by.x='Year', by.y='Year')
   Exploited[is.na(Exploited)] <- 0
   Exploited$total = Exploited$Depl + Exploited$Value
    
  # SPR, extract and subset years
  SPR = mod1$sprseries[, c('Year', 'SPR')]
  SPRyrs = subset(SPR, Year > (Dat_start_mod1 - 1) & Year < (LastYR + 1))
  
  
  # Bind all the columns together for the table
  Timeseries = as.data.frame(cbind(seq(Dat_start_mod1, LastYR, 1), 
                                       Bio_allyrs$Bio_all, 
                                       SpawningByrs$Value,
                                       Depleteyrs$total,
                                       Recruityrs$Value, 
                                       Landingsyrs$Dead_Catch_B, 
                                       Exploited$total,
                                       SPRyrs$SPR))

 # Add colulmn names    
 colnames(Timeseries)=c('Year', 
                        'Total biomass (mt)', 
                        paste0('Spawning biomass', SpawningB_units, ' (mt)'),
                        'Depletion', 
                        'Age-0 recruits', 
                        'Total catch (mt)',
                        'Relative exploitation rate', 
                        'SPR')
 
 # Make year a factor so you don't have a decimal   
 Timeseries$Year = as.factor(Timeseries$Year)
    
 # Remove 2015 values for last three columns since year isn't complete
 Timeseries[nrow(Timeseries), c((ncol(Timeseries) - 2):ncol(Timeseries))] <- NA
```

```{r, results='asis'}
    # Create the time series table
    Timeseries.table = xtable(Timeseries, 
                              caption = c('Time-series of population estimates 
                                        from the base-case model.'),
                              label='tab:Timeseries_mod1',
                              digits = c(0,0,0,0,2,0,0,2,2))   

    # Add alignment
    align(Timeseries.table) = c('l',
                                'c',
                                '>{\\centering}p{.6in}',
                                '>{\\centering}p{.6in}',
                                '>{\\centering}p{.6in}',
                                '>{\\centering}p{.6in}',
                                '>{\\centering}p{.8in}',
                                '>{\\centering}p{.8in}',
                                'c')

    # Print timeseries of population estimates table
    print(Timeseries.table, 
          include.rownames = FALSE, 
          caption.placement = 'top',
          tabular.environment = 'longtable', 
          align=TRUE, 
          floating = FALSE, 
          add.to.row = list(pos = list(0), 
          command = '\\hline \\endhead '))
```
<!-- ---------------------------------------------------------------------- -->

\FloatBarrier

<!-- ***********MODEL 1 HARVEST PROJECTIONS TABLE************************** --> 
\newpage
```{r, results = 'asis'}
    # Pull OFL contribution and subset years
    OFLcatch = mod1$derived_quants[grep('OFLCatch', mod1$derived_quants$LABEL), ]
    OFLcatchyrs = OFLcatch[OFLcatch$LABEL >= paste('OFLCatch_', Project_firstyr, sep = '') &
                           OFLcatch$LABEL <= paste('OFLCatch_', Project_lastyr, sep = ''), ]

    # Pull forecasted landings and subset years
    ForecastC = mod1$timeseries[, grepl('Yr|retain[(]B[)]', names(mod1$timeseries))]
    if (dim(ForecastC)[2] >= 3) { ForecastC$total = rowSums(ForecastC[, -1]) }
    if (dim(ForecastC)[2] == 2) { ForecastC$total = ForecastC[, -1] }
    ForecastCyrs = subset(ForecastC, Yr > (Project_firstyr - 1) & Yr < (Project_lastyr + 1))

    # Pull Age 5+ biomass and subset years
    Age5biomass = mod1$timeseries[, c('Yr', 'Bio_smry')]
    Age5biomassyrs = subset(Age5biomass, Yr > (Project_firstyr - 1) & Yr < (Project_lastyr + 1))


    # Pull spawning biomass and subset years
    SpawningB = mod1$derived_quants[grep('SPB', mod1$derived_quants$LABEL), ]
    SpawningB = SpawningB[c(-1, -2), ]
    SpawningByrs = SpawningB[SpawningB$LABEL >= paste('SPB_', Project_firstyr, sep = '') &
                             SpawningB$LABEL <= paste('SPB_', Project_lastyr, sep = ''), ]

    # Pull depletion and subset years
    Depletion = mod1$derived_quants[grep('Bratio', mod1$derived_quants$LABEL), ]
    Depletion = Depletion[c(-1, -2), ]
    Depletionyrs = Depletion[Depletion$LABEL >= paste('Bratio_', Project_firstyr, sep = '') &
                             Depletion$LABEL <= paste('Bratio_', Project_lastyr, sep = ''), ]

    # Combine the data for the forecast table
    Forecast_mod1 = as.data.frame(cbind(seq(Project_firstyr, Project_lastyr, 1),
                                        OFLcatchyrs$Value,
                                        ForecastCyrs$total,
                                        Age5biomassyrs$Bio_smry,
                                        SpawningByrs$Value,
                                        Depletionyrs$Value))
    # Add column names
    colnames(Forecast_mod1)=c('Year',
                           'OFL contriubtion (mt)',
                           'ACL landings (mt)',
                           'Age 5+ biomass (mt)',
                           'Spawning Biomass (mt)',
                           'Depletion')

    # Make sure year is a factor, so you don't get decimals
    Forecast_mod1$Year = as.factor(Forecast_mod1$Year)

    # Create the forecast table
    Forecast_mod1.table = xtable(Forecast_mod1,
                              caption = c('Projection of potential
                                        OFL, spawning biomass, and depletion for the
                                        base case model.'),
                              label = 'tab:Forecast_mod1', digits = 2)
    # Add alignment
    align(Forecast_mod1.table) = c('l',
                                   'c',
                                   '>{\\centering}p{1in}',
                                   '>{\\centering}p{1in}',
                                   '>{\\centering}p{1in}',
                                   '>{\\centering}p{1in}',
                                   '>{\\centering}p{1in}')

    # Print model 1 forecast table
    print(Forecast_mod1.table,
          include.rownames = FALSE,
          caption.placement = 'top')
```
<!-- ---------------------------------------------------------------------- -->
\FloatBarrier


<!-- ********************************************************************** -->
<!-- ************************MODEL 2 TABLES******************************** --> 
<!-- ********************************************************************** -->



<!-- ********************************************************************** -->
<!-- ************************MODEL 3 TABLES******************************** --> 
<!-- ********************************************************************** -->



<!-- ====================================================================== --> 
<!-- *************************          *********************************** --> 
<!-- *************************END TABLES*********************************** --> 
<!-- *************************          *********************************** --> 
<!-- ====================================================================== --> 






<!-- ====================================================================== -->
<!-- **************************             ******************************* --> 
<!-- **************************BEGIN FIGURES******************************* --> 
<!-- **************************             ******************************* -->
<!-- ====================================================================== -->
\FloatBarrier

\newpage


#Figures

<!-- ====================================================================== --> 
<!-- *********************INTRODUCTION FIGURES***************************** --> 
<!-- ====================================================================== --> 

![Map showing the state boundary lines for management of the recreational fishing fleets.  CRFS Districts 1-6 in California are presented as well as the WDFW Recreational Management Areas in Washington.  Florence, OR is shown as a potential location of model stratification. \label{fig:boundary_map}](Figures/boundary_map.png)







<!-- ********************************************************************** --> 
<!-- *************************Data FIGURES********************************* --> 
<!-- ********************************************************************** -->

![Summary of data sources used in the `r mod1_label`. \label{fig:data_plot}](r4ss/plots_mod1/data_plot.png)






\FloatBarrier

<!-- ********************************************************************** --> 
<!-- ******************Commercial landings FIGURES************************* --> 
<!-- *either read in data to create figure or load in figures from analyst* --> 
<!-- *******************one example of each here*************************** -->





\FloatBarrier

<!-- ********************************************************************** --> 
<!-- *****************Commercial Discards FIGURES************************** --> 
<!-- ********************************************************************** -->






<!-- ********************************************************************** -->
<!-- ************Recreational Landings and Discards FIGURES**************** --> 
<!-- ********************************************************************** -->







\FloatBarrier

<!-- ********************************************************************** -->
<!-- ****************Oregon commercial logbook FIGURES********************* -->
<!-- ********************************************************************** --> 




\FloatBarrier

<!-- ********************************************************************** -->
<!-- ***************Recreational dockside survey FIGURES********************--> 
<!-- ********************************************************************** -->









\FloatBarrier

<!-- ********************************************************************** -->
<!-- *************Recreational onboard observer FIGURES******************** --> 
<!-- ********************************************************************** -->








\FloatBarrier

<!-- ====================================================================== -->
<!-- *****************                             ************************ -->
<!-- *****************START BIOLOGICAL DATA FIGURES************************ --> 
<!-- *****************                            ************************ -->
<!-- ====================================================================== -->



<!-- ********************************************************************** -->
<!-- ****************Length and Age Composition FIGURES******************** --> 
<!-- ********************************************************************** -->


<!-- ***********MODEL 1**************************************************** -->
 
```{r, results='asis'}
    # Plot all of the timeseries plots
      for(i in 1:10) { #dim(LenComp_mod1)[1]) {
       
        # find matches to multi-page plots
        page_test = sapply(multi_page_fig, grepl, LenComp_mod1$label[i])
       
       # if the plot is page2+ of a series, add the extra caption
        if(TRUE %in% page_test) {
         cat('\n![](', LenComp_mod1[i, path_col], ')', sep='')
      
         cat('\\begin{center} \n
              Figure continued from previous page \n
             \\end{center}',sep='')
       
       } else {

        cat('\n![', LenComp_mod1[i,caption_col], ' \\label{fig:mod1_', i, '_', LenComp_mod1[i, label_col], '}](', LenComp_mod1[i, path_col], ')\n', sep='')
 } }
```







\FloatBarrier

<!--RESEARCH Age and lengh composition figures-->




<!-- ********************************************************************** -->
<!-- *****************Maturity and Fecundity FIGURES*********************** --> 
<!-- ********************************************************************** -->







<!-- ********************************************************************** -->
<!-- **********************Age structure FIGURES*************************** --> 
<!-- ********************************************************************** -->








<!-- ********************************************************************** -->
<!-- ****************Aging Precision and Bias FIGURES********************** --> 
<!-- ********************************************************************** -->






<!-- ====================================================================== -->
<!-- ******************                           ************************* -->
<!-- ******************END BIOLOGICAL DATA FIGURES************************* --> 
<!-- ******************                           ************************* -->
<!-- ====================================================================== -->








<!-- ********************************************************************** -->
<!-- **********************Weight-Length FIGURES*************************** --> 
<!-- ********************************************************************** -->






\FloatBarrier

<!-- ********************************************************************** -->
<!-- ***********History of modelleing approaches FIGURES******************* --> 
<!-- ********************************************************************** -->





<!-- ********************************************************************** -->
<!-- ****************STAR PANEL Recommendations FIGURES******************** --> 
<!-- ********************************************************************** -->





<!-- ********************************************************************** -->
<!-- ****************Model description section FIGURES********************* --> 
<!-- ********************************************************************** -->




\FloatBarrier

<!-- ====================================================================== -->
<!-- *********************BASE MODEL FIGURES******************************* -->
<!-- ====================================================================== -->

<!-- ***********MODEL 1 BASE MODEL FIGURES********************************* --> 


\FloatBarrier


<!-- ***********MODEL 2 BASE MODEL FIGURES********************************* --> 


<!-- ***********MODEL 3 BASE MODEL FIGURES********************************* --> 






<!-- ********************************************************************** -->
<!-- ****************Uncertainty and Sensitivity FIGURES******************* -->
<!-- ********************************************************************** -->

<!-- ***********MODEL 1 Uncertainty and Sensitivity FIGURES**************** --> 







<!-- ********************************************************************** -->
<!-- *****************Retrospective analysis FIGURES*********************** -->
<!-- ********************************************************************** -->

<!-- ***********MODEL 1 Retrospective analysis FIGURE********************** --> 




\FloatBarrier





<!-- ********************************************************************** -->
<!-- ******************Likelihood profile FIGURES************************** --> 
<!-- ********************************************************************** -->

<!-- ***********R0 Likelihood profile FIGURES****************************** --> 


<!-- ***********M Likelihood profile FIGURES******************************* -->



<!-- ***********h Likelihood profile FIGURES******************************* -->


\FloatBarrier

<!-- ***********Post-STAR M Likelihood profile FIGURES********************* -->







<!-- ********************************************************************** -->
<!-- *********************REFERENCE POINTS FIGURES************************* --> 
<!-- ********************************************************************** -->

<!-- ***********MODEL 1 REFERENCE POINTS FIGURES*************************** --> 



\FloatBarrier
<!-- ***********MODEL 2 REFERENCE POINTS FIGURES  -- IF NEEDED ************ --> 


<!-- ***********MODEL 3 REFERENCE POINTS FIGURES  -- IF NEEDED ************ --> 






<!-- ********************************************************************** --> 
<!-- *************************FORECAST FIGURES***************************** --> 
<!-- ********************************************************************** --> 

\newpage




<!-- ====================================================================== -->
<!-- ***************************SS FILES*********************************** -->
<!--*****SS APPENDICES INCLUDED AS A CHILD DOCUMENT TO REMOVE CLUTTER****** -->
<!-- ====================================================================== -->

<!-- Uncomment the following lines to include the appendices - exlude to save runtime -->
<!--  ```{r child='SS_file_appendices.rmd'}
``` --> 

<!-- ====================================================================== -->
<!-- **********REFERENCES - WILL APPEAR AFTER APPENDICES******************* -->
<!-- ====================================================================== -->
\color{black}

#References{-}
\renewcommand{\thepage}{}

<!-- ********************END OF THE DOCUMENT******************************* -->